# V1-012a: Text Cleaning & Noise Removal

**Goal:**  
Produce a **cleaned text view** for indexing/LLM while preserving **raw anchors** for accurate citations.

**Location:**  
`src/ingestion/text_cleaning.py`

---

## Steps
1. **Input:**  
   - Raw page text + spans from `pdf_parser`.

2. **Detect & remove:**  
   - Running headers/footers (repeated lines across many pages).  
   - Page numbers at top/bottom.  
   - Hyphenation at line breaks (`inter- \n national` → `international`).  
   - Multiple spaces & inconsistent newlines.  
   - Common boilerplate text if repeated in >40–50% of pages.

3. **Mark footnotes:**  
   - Lines at page bottom starting with digits/symbols.  
   - Optionally exclude them from v1 indexing.

4. **Preserve anchors:**  
   - Store raw `(page, start, end)` offsets before any cleaning.  
   - Only **cleaned_text** is sent into embeddings, BM25, LLM.

5. **Output:**  
   For each block & chunk store:  
   - `raw_text` + `raw_anchors` (for citations)  
   - `cleaned_text` (for retrieval & generation)

---

## Definition of Done (DoD)
- Noise removal eliminates obvious headers, footers, page numbers, hyphenation artifacts.  
- Raw citations remain accurate via original page offsets.  
- Configurable thresholds for header/footer/footnote removal.  
- Cleaned text improves retrieval quality while citations remain precise.

---

## Dependencies
- V1-010: PDF text extraction  
- V1-013: Layout-aware chunking (will consume cleaned text)
